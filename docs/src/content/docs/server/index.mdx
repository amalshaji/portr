---
title: Server Setup Guide
description: Complete guide to deploying your Portr server infrastructure
---

import { Card, CardGrid, Steps, Aside, Tabs, TabItem } from "@astrojs/starlight/components";

Setting up your Portr server gives you complete control over your tunnel infrastructure. This guide will walk you through deploying a production-ready Portr server.

<Aside type="tip">
  **Quick Start**: For testing, you can run Portr server locally with Docker in under 5 minutes!
</Aside>

## Prerequisites

Before you begin, ensure you have:

<CardGrid>
  <Card title="üñ•Ô∏è Virtual Machine" icon="server">
    **Minimum Requirements:**
    - 2 vCPU, 4GB RAM
    - Docker installed
    - Ubuntu 20.04+ or similar

    *Recommended: Hetzner CX21 or AWS t3.medium*
  </Card>

  <Card title="üåê Domain & DNS" icon="globe">
    **DNS Configuration:**
    - Root domain (example.com)
    - Wildcard subdomain (*.example.com)

    *Both pointing to your server IP*
  </Card>

  <Card title="üîë SSL Management" icon="shield">
    **Certificate Provider:**
    - Cloudflare API token (recommended)
    - Route53 credentials
    - Or manual certificate management
  </Card>

  <Card title="üîê Authentication" icon="user">
    **OAuth Setup (Optional):**
    - GitHub OAuth app
    - For admin dashboard login

    *Can be configured later*
  </Card>
</CardGrid>

## DNS Configuration

Configure your DNS records to point to your server:

| Type | Name | Value | Purpose |
|------|------|-------|---------|
| A | @ | `your-server-ip` | Root domain |
| A | * | `your-server-ip` | Wildcard subdomains |
| AAAA | @ | `your-server-ipv6` | IPv6 support (optional) |
| AAAA | * | `your-server-ipv6` | IPv6 wildcard (optional) |

<Aside type="note">
  **Why wildcard?** Portr creates unique subdomains for each tunnel (e.g., `myapp-abc123.yourdomain.com`). The wildcard record ensures all subdomains route to your server.
</Aside>

## Required Ports

Ensure these ports are open on your server:

| Port Range | Protocol | Purpose |
|------------|----------|---------|
| `80` | TCP | HTTP (redirects to HTTPS) |
| `443` | TCP | HTTPS traffic |
| `2222` | TCP | SSH tunnels |
| `8080` | TCP | Admin dashboard |
| `8081` | TCP | Tunnel server API |
| `30001-40001` | TCP | TCP tunnel range |

## Quick Setup Options

<Tabs>
  <TabItem label="Docker (Recommended)">

The fastest way to get started:

```bash
# Download the docker-compose file
curl -o docker-compose.yml https://raw.githubusercontent.com/amalshaji/portr/main/docker-compose.yml

# Configure environment variables
cp .env.example .env
nano .env

# Start the services
docker-compose up -d
```

  </TabItem>

  <TabItem label="Docker Run">

For a simple single-container setup:

```bash
docker run -d \
  --name portr-server \
  -p 8080:8080 \
  -p 8081:8081 \
  -p 2222:2222 \
  -p 30001-40001:30001-40001 \
  -e DOMAIN=yourdomain.com \
  -e CLOUDFLARE_TOKEN=your_token \
  portr/server:latest
```

  </TabItem>

  <TabItem label="Manual Installation">

Build from source for maximum control:

```bash
# Clone the repository
git clone https://github.com/amalshaji/portr.git
cd portr

# Build the server
cargo build --release

# Run with configuration
./target/release/portr-server --config config.toml
```

  </TabItem>
</Tabs>

## Essential Configuration

### Environment Variables

Create a `.env` file with these essential settings:

```bash
# Domain configuration
DOMAIN=yourdomain.com
SUBDOMAIN_SUFFIX=tunnel

# SSL configuration (choose one)
CLOUDFLARE_TOKEN=your_cloudflare_token
# OR
AWS_ACCESS_KEY_ID=your_aws_key
AWS_SECRET_ACCESS_KEY=your_aws_secret

# Database (optional - uses SQLite by default)
DATABASE_URL=postgresql://user:pass@localhost/portr

# GitHub OAuth (optional)
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret

# Admin settings
ADMIN_EMAIL=admin@yourdomain.com
DEFAULT_TEAM_SIZE=10
```

### SSL Certificate Setup

<CardGrid>
  <Card title="Cloudflare (Recommended)" icon="cloudflare">
    **Automatic SSL with Cloudflare**

    1. Get your [Cloudflare API token](/server/cloudflare-api-token/)
    2. Add to environment variables
    3. Portr handles certificate generation automatically

    ‚úÖ Automatic renewal
    ‚úÖ Wildcard support
    ‚úÖ Zero maintenance
  </Card>

  <Card title="Route53" icon="aws">
    **AWS Route53 Integration**

    1. Configure [Route53 credentials](/resources/route53/)
    2. Set AWS environment variables
    3. Automatic DNS challenge handling

    ‚úÖ AWS ecosystem integration
    ‚úÖ Programmatic management
  </Card>
</CardGrid>

## Verification Steps

After deployment, verify your setup:

<Steps>

1. **Check Service Health**

   ```bash
   # Check if services are running
   docker-compose ps

   # Check logs for any errors
   docker-compose logs portr-server
   ```

2. **Test Domain Resolution**

   ```bash
   # Test main domain
   nslookup yourdomain.com

   # Test wildcard subdomain
   nslookup test.yourdomain.com
   ```

3. **Verify SSL Certificates**

   ```bash
   # Check certificate
   curl -I https://yourdomain.com:8080

   # Should return 200 OK with valid SSL
   ```

4. **Access Admin Dashboard**

   Navigate to `https://yourdomain.com:8080` and verify:
   - Dashboard loads correctly
   - SSL certificate is valid
   - Login works (if OAuth configured)

</Steps>

## Next Steps

<CardGrid>
  <Card title="Install Client" icon="download">
    Install the Portr client on your development machine.

    [Client Installation ‚Üí](/client/installation/)
  </Card>

  <Card title="Create First Tunnel" icon="tunnel">
    Set up your first HTTP tunnel and test the connection.

    [HTTP Tunnels ‚Üí](/client/http-tunnel/)
  </Card>

  <Card title="User Management" icon="users">
    Configure users and manage access control.

    [Admin Guide ‚Üí](/local-development/admin/)
  </Card>
</CardGrid>

## Troubleshooting

### Common Issues

<Aside type="caution" title="Port Conflicts">
  **Issue**: Ports 8080/8081 already in use
  **Solution**: Change ports in docker-compose.yml or stop conflicting services
</Aside>

<Aside type="caution" title="SSL Certificate Errors">
  **Issue**: Certificate generation fails
  **Solution**: Verify DNS records and API tokens are correct
</Aside>

<Aside type="caution" title="Connection Refused">
  **Issue**: Cannot connect to server
  **Solution**: Check firewall rules and ensure all required ports are open
</Aside>

### Getting Help

- üìñ [Full documentation](/)
- üí¨ [GitHub Discussions](https://github.com/amalshaji/portr/discussions)
- üêõ [Report Issues](https://github.com/amalshaji/portr/issues)
- üí° [Feature Requests](https://github.com/amalshaji/portr/issues/new)
